                    ┌─────────────┐
                    │   config    │
                    │  settings   │
                    └──────┬──────┘
                           │
          ┌────────────────┼────────────────┐
          │                │                │
          ▼                ▼                ▼
    ┌──────────┐    ┌────────────┐    ┌──────────┐
    │ database │    │ encryption │    │ ui/styles│
    │connection│    └──────┬─────┘    │  theme   │
    └────┬─────┘           │          └────┬─────┘
         │                 │               │
         ▼                 ▼               ▼
    ┌──────────┐    ┌────────────┐    ┌──────────┐
    │  models  │    │   auth     │    │   ui     │
    └────┬─────┘    │  handlers  │    │components│
         │          └──────┬─────┘    └────┬─────┘
         ▼                 │               │
    ┌──────────┐           ▼               │
    │  repos   │    ┌────────────┐         │
    │(cred,    │◄───│   auth     │         │
    │email,cal)│    │  manager   │         │
    └────┬─────┘    └──────┬─────┘         │
         │                 │               │
         │    ┌────────────┴────────────┐  │
         │    │                         │  │
         │    ▼                         ▼  │
         │ ┌─────────┐           ┌─────────┐
         │ │ email   │           │calendar │
         │ │providers│           │providers│
         │ └────┬────┘           └────┬────┘
         │      │                     │
         │      ▼                     ▼
         │ ┌─────────┐           ┌─────────┐
         │ │ email   │           │calendar │
         │ │ client  │           │ client  │
         │ └────┬────┘           └────┬────┘
         │      │                     │
         │      └──────────┬──────────┘
         │                 │
         ▼                 ▼
    ┌─────────────────────────────┐
    │       sync handlers         │
    │    (email.py, calendar.py)  │
    └──────────────┬──────────────┘
                   │
                   ▼
    ┌─────────────────────────────┐
    │       sync manager          │
    └──────────────┬──────────────┘
                   │
                   ▼
    ┌─────────────────────────────┐◄─────────────┐
    │       ui/screens            │              │
    │  (login, menu, inbox, cal)  │              │
    └──────────────┬──────────────┘              │
                   │                             │
                   ▼                             │
    ┌─────────────────────────────┐              │
    │         ui/app.py           │──────────────┘
    └──────────────┬──────────────┘
                   │
                   ▼
    ┌─────────────────────────────┐
    │         main.py             │
    └─────────────────────────────┘





┌─────────────────────────────────────────────────────────────┐
│                      APP STARTUP                            │
└─────────────────────────────────────────────────────────────┘
                           │
                           ▼
              ┌────────────────────────┐
              │  Check credentials DB  │
              └────────────────────────┘
                           │
           ┌───────────────┴───────────────┐
           │                               │
           ▼                               ▼
   ┌───────────────┐              ┌───────────────┐
   │ Credentials   │              │ No credentials│
   │ exist         │              │ found         │
   └───────────────┘              └───────────────┘
           │                               │
           ▼                               ▼
   ┌───────────────┐              ┌───────────────┐
   │ Decrypt &     │              │ Prompt: Choose│
   │ auto-auth     │              │ auth method   │
   └───────────────┘              └───────────────┘
           │                               │
           │                    ┌──────────┴──────────┐
           │                    ▼                     ▼
           │           ┌──────────────┐      ┌──────────────┐
           │           │ App Password │      │   OAuth 2.0  │
           │           │ flow         │      │   flow       │
           │           └──────────────┘      └──────────────┘
           │                    │                     │
           │                    └──────────┬──────────┘
           │                               │
           │                               ▼
           │                    ┌───────────────────┐
           │                    │ Store encrypted   │
           │                    │ credentials in DB │
           │                    └───────────────────┘
           │                               │
           └───────────────┬───────────────┘
                           │
                           ▼
              ┌────────────────────────┐
              │   MAIN MENU            │
              │   1. Inbox             │
              │   2. Compose           │
              │   3. Calendar          │
              │   4. Settings          │
              │   5. Logout            │
              └────────────────────────┘


